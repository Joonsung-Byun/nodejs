<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NodeBlog List</title>
  <link href="/output.css" rel="stylesheet">
  <style>
    h2 {
      font-size: 1.3rem;
    }

    .singlePost img {
      display: none;
    }

    .cardWrapper:nth-child(1) {
      margin-top: 96px;
    }

    @media (min-width: 768px) {
      .cardWrapper:nth-child(2) {
        margin-top: 96px;
      }
    }

    @media (min-width: 1024px) {
      .cardWrapper:nth-child(3) {
        margin-top: 96px;
      }
    }

    @media (min-width: 1441px) {
      .cardWrapper {
        flex-basis: 23%;
      }

      .cardWrapper:nth-child(4) {
        margin-top: 96px;
      }
    }

    @media (min-width: 1921px) {
      .cardWrapper {
        flex-basis: 18%;
      }

      .cardWrapper:nth-child(5) {
        margin-top: 96px;
      }
    }

    #listWrapper {
      height: auto;
      min-height: 100%;
      padding-bottom: 50px;
    }

    #pagination {
      position: relative;
      transform: translateY(-150%);
    }
  </style>
</head>

<body class="bg-white pb-4">
  <%- include('nav.ejs') %>
  <div class="min-h-screen">
    <div id="listWrapper" class="p-4 h-auto min-h-full ">
      <% if(posts.length===0) {%>
      <div class="mx-auto">
        <h1 class="text-2xl font-semibold mt-20"> No posts yet. Create one! </h1>
      </div>
      <%} else {%>
      <div class="drop-shadow-lg pb-4 flex flex-wrap justify-center w-full gap-x-4">
        <% for (let i=0; i < posts.length; i++) {%>
        <div class="cardWrapper duration-300 hover:-translate-y-3 flex flex-col gap-2 bg-white rounded drop-shadow-lg overflow-hidden mb-6 pb-2 basis-11/12 md:basis-[48%] lg:basis-3/12">
          <a class="h-full" href=<%- `/detail/${posts[i].id}` %>>
            <section class="relative w-full">
              <% if(posts[i].thumbnailUrl !=="" ) { %> <img src="<%- posts[i].thumbnailUrl %>" alt="hero" class="block object-cover h-auto max-h-64 w-full ">
              <% } else {%>
              <img src="/images/placeholder.jpg" alt="hero" class="block object-cover h-auto max-h-64 w-full ">
              <%}%>
            </section>

            <section class="flex flex-col gap-4 justify-between pt-2 px-2">
              <div class="flex flex-col gap-1 singlePost">
                <h2 class="font-semibold "><%= posts[i].title %></h2> 
                <span class="data-content"><%- posts[i].markdownContent %></span>
              </div> 

              <div class="flex gap-3">
                <% console.log(commentsResult[i]) %>
                <span><%- posts[i].createdAt %></span>
                <span>•</span>
                <span><%= commentsResult[i]%>  <%= commentsResult[i] == 0 || commentsResult[i] ==1 ? 'comment' : 'comments' %> </span>
              </div>

                
            </section>

        <section class="pt-2 px-2 flex gap-2 border-t-2">
          <div>
            <span>by <strong><%- posts[i].writer %></strong></span>
            <span class="py-1 px-2 rounded-2xl h-9 border-gray-400 listLikes" data-id=<%- posts[i].id %>>❤️ <%- likesResult[i]  %> </span>
          </div>

          
        </section>



        </a>
      </div>
      <% }%>
      <% }%>
    </div>
  </div>
  </div>
  <ul class="flex items-center justify-center w-full -space-x-px text-base mt-4 h-12" id="pagination">
    <li id="previousBtn"> <a href="/list/<%= parseInt(currentPage) - parseInt(1) %>" class="flex items-center justify-center px-4 h-10 ms-0 leading-tight text-gray-500  bg-white border border-e-0 border-gray-300 rounded-s-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">
        <span class="sr-only">Previous</span> <svg class="w-3 h-3 rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 1 1 5l4 4" />
        </svg> </a> </li>
    <% const amount=Math.ceil(total / 6) %>
    <% for(let i=0; i< amount; i++) {%>
    <li class="border"> <a href="/list/<%= i+1 %>" data-page="page_<%= i+1 %>" class="page_btn flex items-center justify-center px-4 h-10 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">
        <%= i+1 %>
      </a> </li>
    <% } %>
    <li id="nextBtn"> <a href="/list/<%= parseInt(currentPage) + parseInt(1) %>" class="flex items-center justify-center px-4 h-10 leading-tight text-gray-500 border bg-white border-gray-300 rounded-e-lg hover:bg-gray-100 hover:text-gray-700  dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">
        <span class="sr-only">Next</span> <svg class="w-3 h-3 rtl:rotate-180" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 6 10">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 9 4-4-4-4" />
        </svg> </a> </li>
  </ul>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="/list.js"></script>
</body>

</html>